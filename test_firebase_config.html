<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Firebase Config - PRO Concursos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Teste de Configura√ß√£o Firebase</h1>
    <div id="results"></div>

    <script type="module">
        const resultsDiv = document.getElementById('results');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            resultsDiv.appendChild(div);
            console.log(message);
        }

        // Teste 1: Verificar hostname
        const hostname = window.location.hostname;
        log(`Hostname detectado: ${hostname}`);

        // Teste 2: Verificar se est√° no dom√≠nio correto
        const isProConcursos = hostname.includes('proconcursos.com.br');
        if (isProConcursos) {
            log('‚úÖ Dom√≠nio correto detectado (proconcursos.com.br)', 'success');
        } else {
            log('‚ùå Dom√≠nio incorreto. Deve ser proconcursos.com.br', 'error');
        }

        // Teste 3: Verificar se Firebase est√° carregado
        if (typeof firebase !== 'undefined') {
            log('‚úÖ Firebase SDK carregado', 'success');

            // Teste 4: Verificar configura√ß√£o do firebase-config.js
            try {
                if (!window.firebaseConfig) {
                    throw new Error('firebase-config.js n√£o foi carregado ou window.firebaseConfig n√£o est√° definido');
                }

                log(`Configura√ß√£o carregada - authDomain: ${window.firebaseConfig.authDomain}`);

                // Verificar se authDomain est√° correto
                if (window.firebaseConfig.authDomain !== 'nvp-concursos.firebaseapp.com') {
                    log('‚ùå ERRO: authDomain deve ser "nvp-concursos.firebaseapp.com" para funcionar corretamente', 'error');
                    log('üîß SOLU√á√ÉO: Verifique se firebase-config.js est√° configurado corretamente', 'error');
                } else {
                    log('‚úÖ authDomain configurado corretamente', 'success');
                }

                log('Tentando inicializar Firebase...');
                firebase.initializeApp(window.firebaseConfig);
                log('‚úÖ Firebase inicializado com sucesso', 'success');

                // Teste 5: Verificar Auth
                const auth = firebase.auth();
                log('‚úÖ Firebase Auth inicializado', 'success');

                // Teste 6: Verificar conectividade
                log('Testando conectividade com Firebase...');
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        log(`‚úÖ Usu√°rio autenticado: ${user.email}`, 'success');
                    } else {
                        log('‚ÑπÔ∏è  Nenhum usu√°rio autenticado (normal)', 'info');
                    }
                });

            } catch (error) {
                log(`‚ùå Erro ao inicializar Firebase: ${error.message}`, 'error');
                if (error.code === 'auth/unauthorized-domain') {
                    log('üîß SOLU√á√ÉO: Adicione "proconcursos.com.br" aos dom√≠nios autorizados no Firebase Console', 'error');
                }
            }

        } else {
            log('‚ùå Firebase SDK n√£o carregado', 'error');
        }

        // Teste 7: Verificar se estamos em produ√ß√£o
        const isProduction = !hostname.includes('localhost') && !hostname.includes('127.0.0.1');
        if (isProduction) {
            log('‚úÖ Ambiente de produ√ß√£o detectado', 'success');
        } else {
            log('‚ÑπÔ∏è  Ambiente de desenvolvimento detectado', 'info');
        }

        log('\n=== RESUMO DOS TESTES ===');
        log('Se todos os testes acima estiverem verdes (‚úÖ), a configura√ß√£o est√° correta.');
        log('Se houver erros vermelhos (‚ùå), siga as instru√ß√µes no FIREBASE_SETUP.md');
    </script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
</body>
</html>
